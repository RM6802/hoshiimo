<% if user_signed_in? %>

<div class="container-fluid">
  <h3><%= "#{current_user.name}さんの投稿一覧" %></h3>
  <% if @posts.present? %>
    <p>
      <span class="green" style="color:#abd700;">緑:未購入</span><br>
      <span class="red" style="color:#ffab6b;">赤:購入済</span>
    </p>
  <% end %>

  <div><%= link_to "新規投稿を作成", new_post_path, class: "btn btn-lg btn-primary" %></div>
  <div><%= link_to "#{current_user.name}さんの未購入一覧へ", user_unpurchases_path(current_user) %></div>
  <div><%= link_to "#{current_user.name}さんの購入済一覧へ", user_purchases_path(current_user) %></div><br />

  <div class="posts">
    <%= paginate @posts %>
    <% if @posts.present? %>
      <% @posts.each do |post| %>
        <div class="list-group">
          <li class="list-group-item">
            <% if post.purchased == false %>
              <div class="unpurchased">
                <%= link_to gravatar_for(post.user, size: 50), post.user %>
                <span class="user">
                  <%= post.user.name %>
                </span>
                <span class="post"><%= link_to post.name, post_path(post) %></span>
                <span class="published">
                  <% if post.published == false %>
                    公開設定：非公開
                  <% else %>
                    公開設定：公開
                  <% end %>
                </span>
                <span class="timestamp">
                  投稿時間：<%= time_ago_in_words(post.created_at) %>前
                  <%= link_to "削除", post_path(post), method: :delete,
                                                   data: { confirm: "You sure?" } %>
                </span>
              </div>
            <% else %>
              <div class="purchased">
                <%= link_to gravatar_for(post.user, size: 50), post.user %>
                <span class="user">
                  <%= post.user.name %>
                </span>
                <span class="post"><%= link_to post.name, post_path(post) %></span>
                <span class="published">
                  <% if post.published == false %>
                    公開設定：非公開
                  <% else %>
                    公開設定：公開
                  <% end %>
                </span>
                <span class="timestamp">
                  投稿時間：<%= time_ago_in_words(post.created_at) %>前
                  <%= link_to "削除", post_path(post), method: :delete,
                                                   data: { confirm: "You sure?" } %>
                </span>
              </div>
            <% end %>
          </li>
        </div>
      <% end %>
    <% else %>
      <h3>投稿がありません</h3>
    <% end %>
    <%= paginate @posts %>
  </div>
</div>

<% else %>
  <div class="container-fluid">
    <div class="text-content">
      <h1>欲しいものを記録する</h1>
      <p class="lead">
        管理から共有まで自由な使い方を
      </p>
    </div>
    <div class="form-wrap">
      <div class="signup">
        <%= link_to '新規登録', new_user_registration_path, class: "btn btn-lg btn-primary" %>
      </div><br />
      <div class="signin">
        <%= link_to 'ログイン', new_user_session_path, class: "btn btn-lg btn-primary" %>
      </div>
    </div>
  </div>
<% end %>
